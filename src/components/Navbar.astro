---
// Header.astro
---

<header
  class="fixed top-0 z-50 w-full bg-cyan-950/95 backdrop-blur-md shadow-sm transition-all duration-300"
>
  <div class="container mx-auto px-4">
    <!-- Top Bar -->
    <div class="flex items-center justify-between py-3">
      <!-- Logo and Mobile Menu Button -->
      <div class="flex items-center">
        <!-- Mobile Menu Button (hidden on desktop) -->
        <button
          class="md:hidden text-white mr-4"
          aria-label="Toggle menu"
          id="mobile-menu-button"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>

        <!-- Logo -->
        <a href="/" class="flex items-center" aria-label="EZVIZ Home">
          <img
            src="/images/logo.png"
            alt="EZVIZ Logo"
            class="h-10 w-auto object-contain"
            width="140"
            height="40"
          />
        </a>
      </div>

      <!-- Desktop Navigation -->
      <nav class="hidden md:flex items-center space-x-8">
        <a
          href="/"
          class="nav-link text-white hover:text-gray-400 font-medium transition-colors duration-200"
          >Home</a
        >
        <a
          href="/aboutus"
          class="nav-link text-white hover:text-gray-400 font-medium transition-colors duration-200"
          >About</a
        >

        <!-- Products Dropdown -->
        <div class="relative dropdown-parent group">
          <button
            class="nav-link products-link text-white hover:text-gray-400 font-medium transition-all duration-300 flex items-center"
          >
            Products
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 ml-1 transition-transform duration-300 dropdown-arrow group-hover:rotate-180"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>

          <!-- Full-Width Dropdown Content -->
          <div
            class="dropdown-menu absolute left-0 w-full bg-white shadow-2xl z-50 overflow-hidden rounded-b-lg opacity-0 invisible transition-all duration-300 group-hover:opacity-100 group-hover:visible"
            style="top: calc(100% + 10px);"
          >
            <div class="px-8 py-8 max-w-7xl mx-auto">
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6">
                <!-- Wire-Free Cameras -->
                <a
                  href="/categories/wireFree"
                  class="product-item group/item block text-center p-4 rounded-xl"
                >
                  <div
                    class="product-image-container overflow-hidden rounded-lg mb-3 mx-auto w-28 h-28 bg-gradient-to-br from-gray-50 to-gray-100"
                  >
                    <img
                      src="/public/images/wifi-free/BC2.png"
                      alt="Wire-Free Cameras"
                      class="product-image w-full h-full object-cover transition-transform duration-500 group-hover/item:scale-125"
                    />
                  </div>
                  <h4
                    class="product-title font-medium text-gray-800 text-sm transition-all duration-300 group-hover/item:text-cyan-600"
                  >
                    Wire-Free Cameras
                  </h4>
                  <p
                    class="product-desc text-xs text-gray-600 mt-1 transition-all duration-300 group-hover/item:text-gray-800"
                  >
                    Battery powered, wireless security
                  </p>
                </a>
                <!-- Outdoor Wi-Fi Cameras -->

                <a
                  href="/categories/outdoorcamera"
                  class="product-item group/item block text-center p-4 rounded-xl"
                >
                  <div
                    class="product-image-container overflow-hidden rounded-lg mb-3 mx-auto w-28 h-28 bg-gradient-to-br from-gray-50 to-gray-100"
                  >
                    <img
                      src="/public/images/outdoor-wifi/LC1C.png"
                      alt="Outdoor Wi-Fi Cameras"
                      class="product-image w-full h-full object-cover transition-transform duration-500 group-hover/item:scale-125"
                    />
                  </div>
                  <h4
                    class="product-title font-medium text-gray-800 text-sm transition-all duration-300 group-hover/item:text-cyan-600"
                  >
                    Outdoor Wi-Fi Cameras
                  </h4>
                  <p
                    class="product-desc text-xs text-gray-600 mt-1 transition-all duration-300 group-hover/item:text-gray-800"
                  >
                    Weatherproof exterior protection
                  </p>
                </a>
                <!-- Indoor Wi-Fi Cameras -->

                <a
                  href="/categories/indoorcamera"
                  class="product-item group/item block text-center p-4 rounded-xl"
                >
                  <div
                    class="product-image-container overflow-hidden rounded-lg mb-3 mx-auto w-28 h-28 bg-gradient-to-br from-gray-50 to-gray-100"
                  >
                    <img
                      src="/public/images//indoor-wifi/C1C-B.png"
                      alt="Indoor Wi-Fi Cameras"
                      class="product-image w-full h-full object-cover transition-transform duration-500 group-hover/item:scale-125"
                    />
                  </div>
                  <h4
                    class="product-title font-medium text-gray-800 text-sm transition-all duration-300 group-hover/item:text-cyan-600"
                  >
                    Indoor Wi-Fi Cameras
                  </h4>
                  <p
                    class="product-desc text-xs text-gray-600 mt-1 transition-all duration-300 group-hover/item:text-gray-800"
                  >
                    Smart home monitoring solutions
                  </p>
                </a>
              </div>

              <!-- View All Products Button -->
              <div
                class="flex justify-center mt-8 pt-6 border-t border-gray-200"
              >
                <a
                  href="/product"
                  class="view-all-btn inline-flex items-center px-8 py-3 bg-gradient-to-r from-cyan-600 to-cyan-700 text-white font-semibold rounded-lg hover:from-cyan-700 hover:to-cyan-800 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
                >
                  View All Products
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5 ml-2 transition-transform duration-300 hover:translate-x-1"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                  </svg>
                </a>
              </div>
            </div>
          </div>
        </div>

        <a
          href="/contact"
          class="nav-link text-white hover:text-gray-400 font-medium transition-colors duration-200"
          >Contact</a
        >
        <a
          href="/support"
          class="nav-link text-white hover:text-gray-400 font-medium transition-colors duration-200"
          >Support</a
        >
      </nav>

      <!-- Right Side Icons -->
      <div class="flex items-center gap-2 sm:gap-3 ml-2">
        <!-- Email -->
        <a
          href="mailto:support@ezviz.com"
          class="text-white hover:text-gray-400 transition-colors duration-200 flex items-center"
          title="Email Us"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
            ></path>
          </svg>
        </a>
        <!-- Phone -->
        <a
          href="tel:+971123456789"
          class="text-white hover:text-green-400 transition-colors duration-200 flex items-center"
          title="Call Us"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H5a2 2 0 01-2-2V5zm0 12a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H5a2 2 0 01-2-2v-2zm12-12a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zm0 12a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"
            ></path>
          </svg>
        </a>
        <!-- Google Maps -->
        <a
          href="https://www.google.com/maps/place/EZVIZ"
          target="_blank"
          rel="noopener"
          class="text-white hover:text-green-400 transition-colors duration-200 flex items-center"
          title="Google Maps"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5S13.38 11.5 12 11.5z"
            ></path>
          </svg>
        </a>
      </div>
    </div>

    <!-- Mobile Navigation (hidden by default) -->
    <nav
      class="md:hidden hidden py-4 border-t border-gray-700"
      id="mobile-menu"
    >
      <div class="flex flex-col space-y-4">
        <a
          href="/"
          class="mobile-nav-link text-white hover:text-cyan-300 font-medium block py-2"
          >Home</a
        >
        <a
          href="/aboutus"
          class="mobile-nav-link text-white hover:text-cyan-300 font-medium block py-2"
          >About</a
        >

        <!-- Mobile Products Dropdown -->
        <div class="relative">
          <button
            class="mobile-nav-link mobile-products-link text-white hover:text-cyan-300 font-medium w-full text-left py-2 flex items-center justify-between"
            id="mobile-products-button"
          >
            Products
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4 ml-1 transform transition-transform"
              id="mobile-products-arrow"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>

          <div class="hidden pl-4 mt-2 space-y-2" id="mobile-products-menu">
            <a
              href="/categories/wireFree"
              class="text-white hover:text-cyan-300 font-medium block py-2"
              >Wire-Free Cameras</a
            >
            <a
              href="/categories/outdoorcamera"
              class="text-white hover:text-cyan-300 font-medium block py-2"
              >Outdoor Wi-Fi Cameras</a
            >
            <a
              href="/categories/indoorcamera"
              class="text-white hover:text-cyan-300 font-medium block py-2"
              >Indoor Wi-Fi Cameras</a
            >
            <div class="pt-2 mt-2 border-t border-gray-600">
              <a
                href="/product"
                class="text-cyan-300 hover:text-cyan-200 font-semibold block py-2"
                >View All Products â†’</a
              >
            </div>
          </div>
        </div>

        <a
          href="/contact"
          class="mobile-nav-link text-white hover:text-cyan-300 font-medium block py-2"
          >Contact</a
        >
        <a
          href="/support"
          class="mobile-nav-link text-white hover:text-cyan-300 font-medium block py-2"
          >Support</a
        >
      </div>
    </nav>
  </div>
</header>

<style>
  /* Enhanced dropdown styling with smooth professional animations */
  .dropdown-menu {
    position: fixed !important;
    left: 0 !important;
    right: 0 !important;
    top: 64px; /* Adjust if your header is taller/shorter */
    width: 100vw !important;
    max-width: 100vw !important;
    min-width: 0 !important;
    border-radius: 0 0 1rem 1rem;
    z-index: 1000;
    margin: 0;
    box-shadow:
      0 20px 40px -10px rgba(0, 0, 0, 0.15),
      0 10px 15px -5px rgba(0, 0, 0, 0.08);
    border-top: 3px solid #06b6d4;
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    opacity: 0;
    visibility: hidden;
    transform: translateY(-20px) scale(0.98);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    padding-top: 0; /* Remove space between navbar and dropdown */
    backdrop-filter: blur(10px);
  }

  .dropdown-parent:hover .dropdown-menu,
  .dropdown-menu:hover {
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto;
    transform: translateY(0) scale(1);
  }

  /* Smooth product item animations */
  .product-item {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateY(0);
  }

  .product-item:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 25px -8px rgba(6, 182, 212, 0.25);
  }

  /* Enhanced product image hover effects - UPDATED */
  .product-image-container {
    position: relative;
    overflow: hidden;
    border: 2px solid transparent;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Remove border and add subtle shadow on hover instead */
  .product-item:hover .product-image-container {
    border-color: transparent;
    box-shadow: 0 8px 20px -5px rgba(6, 182, 212, 0.2);
  }

  /* Image scaling effect - ENHANCED */
  .product-image {
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Staggered animation for dropdown items */
  .dropdown-menu .grid > * {
    opacity: 0;
    transform: translateY(20px);
    animation: slideInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }

  .dropdown-parent:hover .dropdown-menu .grid > *:nth-child(1) {
    animation-delay: 0.1s;
  }
  .dropdown-parent:hover .dropdown-menu .grid > *:nth-child(2) {
    animation-delay: 0.15s;
  }
  .dropdown-parent:hover .dropdown-menu .grid > *:nth-child(3) {
    animation-delay: 0.2s;
  }
  .dropdown-parent:hover .dropdown-menu .grid > *:nth-child(4) {
    animation-delay: 0.25s;
  }
  .dropdown-parent:hover .dropdown-menu .grid > *:nth-child(5) {
    animation-delay: 0.3s;
  }
  .dropdown-parent:hover .dropdown-menu .grid > *:nth-child(6) {
    animation-delay: 0.35s;
  }

  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Enhanced view all button animation */
  .view-all-btn {
    position: relative;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .view-all-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 15px 30px -8px rgba(6, 182, 212, 0.4);
  }

  .view-all-btn::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    transition: left 0.5s;
  }

  .view-all-btn:hover::before {
    left: 100%;
  }

  /* Remove container padding for dropdown */
  .dropdown-menu > .max-w-7xl {
    max-width: 100vw !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  /* Responsive grid for dropdown */
  .dropdown-menu .grid {
    grid-template-columns: repeat(6, 1fr);
    gap: 2rem;
    padding: 2rem 4rem;
  }
  @media (max-width: 1280px) {
    .dropdown-menu .grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      padding: 2rem 1rem;
    }
  }
  @media (max-width: 768px) {
    .dropdown-menu .grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      padding: 1rem 0.5rem;
    }
  }

  /* Prevent content overlap */
  body {
    position: relative;
    z-index: 0;
  }
  header {
    z-index: 1100;
  }

  /* Active bar for nav links */
  .nav-link,
  .mobile-nav-link {
    position: relative;
  }
  .nav-link::after,
  .mobile-nav-link::after {
    content: "";
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -4px;
    left: 0;
    background-color: #38bdf8;
    transition: width 0.3s;
    border-radius: 2px;
  }
  .nav-link.active::after,
  .nav-link[aria-current="page"]::after,
  .mobile-nav-link.active::after,
  .mobile-nav-link[aria-current="page"]::after {
    width: 100%;
  }
  .nav-link.active,
  .nav-link[aria-current="page"],
  .mobile-nav-link.active,
  .mobile-nav-link[aria-current="page"] {
    color: #38bdf8 !important;
    font-weight: bold;
  }
</style>

<script>
  // Mobile menu toggle
  document
    .getElementById("mobile-menu-button")
    ?.addEventListener("click", function () {
      const menu = document.getElementById("mobile-menu");
      menu?.classList.toggle("hidden");
    });

  // Mobile products menu toggle
  document
    .getElementById("mobile-products-button")
    ?.addEventListener("click", function () {
      const menu = document.getElementById("mobile-products-menu");
      const arrow = document.getElementById("mobile-products-arrow");
      menu?.classList.toggle("hidden");
      arrow?.classList.toggle("rotate-180");
    });

  // Header scroll effects - DISABLED (keeping header fixed)
  // Uncomment the code below if you want the header to hide/show on scroll
  /*
  let lastScroll = 0;
  const header = document.querySelector('header');
  
  window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;
    
    if (currentScroll <= 0) {
      header?.classList.remove('shadow-lg');
      return;
    }
    
    if (currentScroll > lastScroll && currentScroll > 100) {
      header?.classList.add('-translate-y-full');
    } else {
      header?.classList.remove('-translate-y-full');
    }
    
    lastScroll = currentScroll;
  });
  */

  // Active page highlighting - FIXED VERSION
  document.addEventListener("DOMContentLoaded", () => {
    const path = window.location.pathname;

    // Helper: check if path is product-related
    function isProductActive(path) {
      return (
        path === "/product" ||
        path === "/products" ||
        path.startsWith("/product/") ||
        path.startsWith("/products/") ||
        path.startsWith("/categories/") ||
        path.startsWith("/wifi-free/") ||
        path.startsWith("/outdoor-wifi/") ||
        path.startsWith("/indoor-wifi/")
      );
    }

    // Clear all active states first
    document.querySelectorAll(".nav-link, .mobile-nav-link").forEach((link) => {
      link.classList.remove("active");
      link.removeAttribute("aria-current");
    });

    // Desktop navigation
    document.querySelectorAll(".nav-link").forEach((link) => {
      const href = link.getAttribute("href");

      if (link.classList.contains("products-link")) {
        // Products button (not a regular link)
        if (isProductActive(path)) {
          link.classList.add("active");
          link.setAttribute("aria-current", "page");
        }
      } else if (href && href === path) {
        // Regular nav links
        link.classList.add("active");
        link.setAttribute("aria-current", "page");
      }
    });

    // Mobile navigation
    document.querySelectorAll(".mobile-nav-link").forEach((link) => {
      const href = link.getAttribute("href");

      if (link.classList.contains("mobile-products-link")) {
        // Mobile products button
        if (isProductActive(path)) {
          link.classList.add("active");
          link.setAttribute("aria-current", "page");
        }
      } else if (href && href === path) {
        // Regular mobile nav links
        link.classList.add("active");
        link.setAttribute("aria-current", "page");
      }
    });
  });

  // Keep dropdown open when hovering
  const dropdownParent = document.querySelector(".dropdown-parent");
  const dropdownMenu = document.querySelector(".dropdown-menu");

  if (dropdownParent && dropdownMenu) {
    dropdownParent.addEventListener("mouseenter", () => {
      dropdownMenu.classList.add("opacity-100", "visible");
    });

    dropdownParent.addEventListener("mouseleave", () => {
      dropdownMenu.classList.remove("opacity-100", "visible");
    });

    dropdownMenu.addEventListener("mouseenter", () => {
      dropdownMenu.classList.add("opacity-100", "visible");
    });

    dropdownMenu.addEventListener("mouseleave", () => {
      dropdownMenu.classList.remove("opacity-100", "visible");
    });
  }

  // Close mobile menu when clicking outside
  document.addEventListener("click", function (event) {
    const mobileMenu = document.getElementById("mobile-menu");
    const mobileButton = document.getElementById("mobile-menu-button");

    if (
      mobileMenu &&
      !mobileMenu.contains(event.target as Node) &&
      !mobileButton.contains(event.target as Node)
    ) {
      mobileMenu.classList.add("hidden");
    }
  });

  // Keyboard navigation support
  document.addEventListener("keydown", function (event) {
    if (event.key === "Escape") {
      const mobileMenu = document.getElementById("mobile-menu");
      const productsMenu = document.getElementById("mobile-products-menu");

      if (mobileMenu && !mobileMenu.classList.contains("hidden")) {
        mobileMenu.classList.add("hidden");
      }
      if (productsMenu && !productsMenu.classList.contains("hidden")) {
        productsMenu.classList.add("hidden");
      }
    }
  });
</script>
