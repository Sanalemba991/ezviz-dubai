---
// src/pages/wire-free/[slug].astro
import Layout from "../../layouts/Layout.astro";
import "../../styles/global.css";
import { getCollection } from 'astro:content';

// Generate static paths for each product
export async function getStaticPaths() {
  const products = await getCollection('outdoor-wifi');
  return products.map((product) => ({
    params: { slug: product.slug },
    props: { product },
  }));
}

// Get the product data passed from getStaticPaths
const { product } = Astro.props;
const { data, body } = product;

// Set page metadata
const pageTitle = `${data.title} | Wire-Free Security Cameras`;
const pageDescription = data.description;
---

<Layout title={pageTitle} description={pageDescription}>
  <!-- Main Product Section -->
  <section class="bg-white py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Breadcrumb Navigation -->
      <nav class="flex mb-8" aria-label="Breadcrumb">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
          <li class="inline-flex items-center">
            <a href="/" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600">
              <i class="fas fa-home mr-2"></i>
              Home
            </a>
          </li>
          <li>
            <div class="flex items-center">
              <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
              <a href="/wire-free" class="ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2">Wire-Free Cameras</a>
            </div>
          </li>
          <li aria-current="page">
            <div class="flex items-center">
              <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
              <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2">{data.title}</span>
            </div>
          </li>
        </ol>
      </nav>

      <!-- Product Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Image Gallery -->
        <div class="space-y-6">
          <!-- Main Image -->
          <div class="bg-gray-100 rounded-xl overflow-hidden shadow-lg">
            <img 
              src={data.image} 
              alt={data.title}
              class="w-full h-auto object-contain max-h-[500px] mx-auto"
              loading="eager"
            />
          </div>

          <!-- Thumbnail Gallery -->
          {data.images && data.images.length > 0 && (
            <div class="grid grid-cols-4 gap-4">
              {data.images.map((img, index) => (
                <button 
                  class="thumbnail-btn bg-gray-100 rounded-lg overflow-hidden shadow hover:ring-2 hover:ring-blue-500 transition-all"
                  onclick={`document.querySelector('.main-image').src = '${img.url}'`}
                >
                  <img 
                    src={img.url} 
                    alt={img.caption || `${data.title} - Image ${index + 1}`}
                    class="w-full h-24 object-cover"
                  />
                </button>
              ))}
            </div>
          )}
        </div>

        <!-- Product Details -->
        <div>
          <h1 class="text-3xl font-bold text-gray-900 mb-2">{data.title}</h1>
          
          <!-- Rating -->
          <div class="flex items-center mb-4">
            <div class="flex items-center mr-4">
              {[1, 2, 3, 4, 5].map((star) => (
                <i class={`fas fa-star ${star <= 4 ? 'text-yellow-400' : 'text-gray-300'} mr-1`}></i>
              ))}

            </div>
            
          </div>

          <!-- Price -->
          <div class="mb-6">
            <span class="text-3xl font-bold text-gray-900">{data.price}</span>
          </div>

          <!-- Description -->
          <div class="prose max-w-none mb-8">
            <p>{data.description}</p>
          </div>

          <!-- Key Features -->
          <div class="mb-8">
            <h3 class="text-lg font-semibold mb-4">Key Features</h3>
            <ul class="space-y-3">
              {data.features.map((feature, index) => (
                <li class="flex items-start">
                  <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                  <span>{feature}</span>
                </li>
              ))}
            </ul>
          </div>

          <!-- Add to Cart -->
         
            <button class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
              <i class="fas fa-shopping-cart mr-2"></i> Add to Cart
            </button>
          </div>

          <!-- Share Buttons -->
          <div class="flex items-center space-x-4">
            <span class="text-gray-600">Share:</span>
            <a href="#" class="text-gray-500 hover:text-blue-500">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="#" class="text-gray-500 hover:text-blue-400">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="text-gray-500 hover:text-pink-500">
              <i class="fab fa-pinterest"></i>
            </a>
          </div>
        </div>
      </div>

      <!-- Specifications Section -->
      <div class="mt-16">
        <h2 class="text-2xl font-bold mb-6">Specifications</h2>
        <div class="bg-gray-50 rounded-xl p-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            {Object.entries(data.specification).map(([key, value]) => (
              <div class="border-b border-gray-200 pb-4">
                <dt class="text-gray-500 font-medium">{key}</dt>
                <dd class="mt-1 text-gray-900">{value}</dd>
              </div>
            ))}
          </div>
        </div>
      </div>

      <!-- Related Products (Optional) -->
     
      </div>
    </div>
  </section>

  <style is:global>
    .thumbnail-btn {
      transition: all 0.3s ease;
    }
    .thumbnail-btn:hover {
      transform: translateY(-3px);
    }
    .prose ul {
      list-style-type: none;
      padding-left: 0;
    }
    .prose li {
      margin-bottom: 0.5rem;
    }
  </style>

  <script is:inline>
    document.addEventListener('DOMContentLoaded', function() {
      // Image gallery functionality
      const thumbnails = document.querySelectorAll('.thumbnail-btn');
      const mainImage = document.querySelector('.main-image');
      
      if (thumbnails.length > 0 && mainImage) {
        thumbnails.forEach(thumb => {
          thumb.addEventListener('click', function() {
            // Remove active class from all thumbnails
            thumbnails.forEach(t => t.classList.remove('ring-2', 'ring-blue-500'));
            
            // Add active class to clicked thumbnail
            this.classList.add('ring-2', 'ring-blue-500');
            
            // Update main image
            const newSrc = this.querySelector('img').src;
            mainImage.src = newSrc;
          });
        });
        
        // Activate first thumbnail by default
        thumbnails[0].classList.add('ring-2', 'ring-blue-500');
      }

      // Quantity selector
      const minusBtn = document.querySelector('.quantity-selector button:first-child');
      const plusBtn = document.querySelector('.quantity-selector button:last-child');
      const quantityDisplay = document.querySelector('.quantity-selector span');
      
      if (minusBtn && plusBtn && quantityDisplay) {
        let quantity = 1;
        
        minusBtn.addEventListener('click', function() {
          if (quantity > 1) {
            quantity--;
            quantityDisplay.textContent = quantity;
          }
        });
        
      plusBtn.addEventListener('click', function() {
        quantity++;
        quantityDisplay.textContent = quantity;
      });
    }
  });
</script>
</Layout>