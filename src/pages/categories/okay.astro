---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from 'astro:content';
import "../../styles/global.css";

const products = await getCollection('wire-free');
---
<Layout>
    <style>
        /* Add the fixed layout CSS from above here */
        /* Your existing animations and styles */
        
        /* CRITICAL: Add these new fixed layout styles */
        html, body {
            height: 100vh;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }

        .main-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .hero-banner {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            position: relative;
            overflow: hidden;
            height: 50vh; /* Fixed height */
            display: flex;
            align-items: center;
            width: 100%;
            flex-shrink: 0;
        }

        .scrollable-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 2rem 0;
        }

        .scrollable-content::-webkit-scrollbar {
            width: 8px;
        }

        .scrollable-content::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }

        .scrollable-content::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 10px;
        }

        .scrollable-content::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Keep all your existing styles for animations, product cards, etc. */
        /* ... (keep all your existing CSS) ... */
        
    </style>

    <!-- NEW: Wrap everything in a main container -->
    <div class="main-container">
        <!-- FIXED: Hero Banner (doesn't scroll) -->
        <section class="hero-banner">
            <div class="w-full relative z-10">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center py-16">
                        <!-- Left Content -->
                        <div class="text-white hero-content">
                            <h1 class="text-5xl lg:text-6xl font-bold mb-6 leading-tight">
                                Wire-Free <span class="text-blue-400">Security Cameras</span>
                            </h1>
                            <p class="text-lg text-slate-200 mb-8 leading-relaxed max-w-lg animate-on-scroll">
                                Revolutionary battery-powered surveillance with AI-driven detection, crystal-clear 4K recording, and seamless smart home integration.
                            </p>
                            <div class="flex flex-col sm:flex-row gap-4">
                                <button class="animated-button inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium text-base transition-all duration-300 shadow-lg hover:shadow-xl">
                                    <i class="fas fa-play mr-2"></i>
                                    Watch Demo
                                </button>
                                <button onclick="document.querySelector('.scrollable-content').scrollTo({top: 0, behavior: 'smooth'})" class="animated-button inline-flex items-center justify-center border border-slate-300 hover:border-white text-white px-8 py-3 rounded-lg font-medium text-base hover:bg-white hover:text-slate-900 transition-all duration-300">
                                    Explore Products
                                    <i class="fas fa-arrow-down ml-2"></i>
                                </button>
                            </div>

                            <!-- Stats -->
                            <div class="grid grid-cols-3 gap-8 pt-8 border-t border-white/20">
                                <div class="stat-item text-center">
                                    <div class="text-2xl font-bold text-blue-400 mb-2">365+</div>
                                    <div class="text-sm text-slate-300">Days Battery Life</div>
                                </div>
                                <div class="stat-item text-center">
                                    <div class="text-2xl font-bold text-blue-400 mb-2">4K</div>
                                    <div class="text-sm text-slate-300">Ultra HD Quality</div>
                                </div>
                                <div class="stat-item text-center">
                                    <div class="text-2xl font-bold text-blue-400 mb-2">AI</div>
                                    <div class="text-sm text-slate-300">Smart Detection</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Right Content - Camera Visualization -->
                        <div class="relative hidden lg:block hero-image">
                            <div class="relative mx-auto h-96 w-96 floating-element">
                                <div class="absolute inset-0 rounded-full bg-gradient-to-r from-blue-500/20 to-purple-500/20 animate-pulse"></div>
                                <div class="absolute inset-4 rounded-full bg-gradient-to-r from-white/10 to-white/5 backdrop-blur-lg border border-white/20">
                                    <div class="flex h-full items-center justify-center">
                                        <i class="fas fa-video text-6xl text-white opacity-80"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SCROLLABLE: Main Content Section -->
        <div class="scrollable-content">
            <section class="main-content-section">
                <!-- Background Elements -->
                <div class="absolute inset-0 bg-[url('/grid-pattern.svg')] opacity-5 dark:opacity-10"></div>

                <div class="relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                    <!-- Search and Filter Section -->
                    <div class="mb-16 space-y-8">
                        <!-- Search Bar -->
                        <div class="relative max-w-2xl mx-auto">
                            <div class="relative">
                                <input
                                    type="text"
                                    id="searchInput"
                                    placeholder="Search cameras by model, features, or specifications..."
                                    class="search-glow w-full px-6 py-4 pl-14 pr-16 text-lg rounded-2xl backdrop-blur-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 shadow-lg hover:shadow-xl"
                                />
                                <div class="absolute inset-y-0 left-0 flex items-center pl-5">
                                    <i class="fas fa-search text-gray-400 text-xl"></i>
                                </div>
                                <button class="absolute inset-y-0 right-0 flex items-center pr-5 text-blue-600 hover:text-blue-700 transition-all duration-300 hover:scale-110">
                                    <i class="fas fa-microphone text-xl"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Filter Buttons -->
                        <div class="flex flex-wrap justify-center gap-4">
                            <button class="filter-btn px-6 py-3 rounded-full font-medium transform hover:scale-105 transition-all duration-300 shadow-lg" data-filter="all">
                                <i class="fas fa-th-large mr-2"></i>All Products
                            </button>
                            <button class="filter-btn px-6 py-3 rounded-full font-medium transform hover:scale-105 transition-all duration-300 shadow-lg" data-filter="battery">
                                <i class="fas fa-battery-full mr-2"></i>Battery Powered
                            </button>
                            <button class="filter-btn px-6 py-3 rounded-full font-medium transform hover:scale-105 transition-all duration-300 shadow-lg" data-filter="pan-tilt">
                                <i class="fas fa-sync-alt mr-2"></i>Pan & Tilt
                            </button>
                            <button class="filter-btn px-6 py-3 rounded-full font-medium transform hover:scale-105 transition-all duration-300 shadow-lg" data-filter="outdoor">
                                <i class="fas fa-cloud-sun mr-2"></i>Outdoor
                            </button>
                            <button class="filter-btn px-6 py-3 rounded-full font-medium transform hover:scale-105 transition-all duration-300 shadow-lg" data-filter="smart">
                                <i class="fas fa-brain mr-2"></i>AI Smart
                            </button>
                        </div>

                        <!-- Sort Options -->
                        <div class="flex justify-between items-center">
                            <div class="text-sm text-black animate-on-scroll">
                                <span id="productCount">{products.length}</span> products found
                            </div>
                            <select
                                id="sortSelect"
                                class="px-4 py-2 border-2 border-blue-300 rounded-lg bg-transparent text-black focus:outline-none focus:ring-4 focus:ring-blue-200 transition-all duration-300 hover:border-blue-500 shadow-[0_2px_8px_rgba(59,130,246,0.08)]"
                            >
                                <option value="default">Sort by Default</option>
                                <option value="name">Sort by Name</option>
                                <option value="newest">Newest First</option>
                                <option value="popular">Most Popular</option>
                            </select>
                        </div>
                    </div>

                    <!-- Enhanced Products Grid -->
                    <div id="products" class="products-grid grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
                        {products.map((product, index) => (
                            <a 
                                href={`/wire-free/${product.slug}`}
                                class="product-card category-item"
                                data-name={product.data.title.toLowerCase()}
                                style={`animation-delay: ${index * 100}ms`}
                            >
                                <!-- Product Image -->
                                <div class="product-image-container">
                                    <img 
                                        src={product.data.image} 
                                        alt={product.data.title}
                                        class="product-image"
                                        loading="lazy"
                                    />
                                </div>

                                <!-- Product Content -->
                                <div class="p-6">
                                    <div class="flex justify-between items-start mb-2">
                                        <h3 class="text-lg font-semibold">
                                            {product.data.title}
                                        </h3>
                                        <div class="rating-stars flex items-center">
                                            <i class="fas fa-star text-yellow-400 text-sm mr-1"></i>
                                            <span class="text-sm font-medium text-gray-700 dark:text-gray-300">
                                                4.5
                                            </span>
                                        </div>
                                    </div>

                                    <p class="product-description text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-2 transition-all duration-300">
                                        {product.data.description}
                                    </p>

                                    <div class="flex justify-between items-center">
                                        <button class="add-to-cart-btn animated-button px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all duration-300">
                                            <i class="fas fa-shopping-cart mr-2"></i>Read More
                                        </button>
                                    </div>
                                </div>
                            </a>
                        ))}
                    </div>

                    <!-- No Results Message -->
                    <div id="noResults" class="hidden text-center py-16">
                        <div class="mx-auto w-64 h-64 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-8">
                            <i class="fas fa-search text-6xl text-gray-400"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">No cameras found</h3>
                        <p class="text-gray-600 dark:text-gray-400 max-w-md mx-auto">
                            Try adjusting your search terms or filters to find the perfect security camera for your needs.
                        </p>
                        <button onclick="clearFilters()" class="animated-button mt-6 px-6 py-3 bg-blue-600 text-white rounded-full font-medium hover:bg-blue-700 transform hover:scale-105 transition-all duration-300">
                            Clear Filters
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Keep your existing script with minor modifications -->
    <script is:inline>
        document.addEventListener("DOMContentLoaded", function () {
            // Your existing JavaScript code remains mostly the same
            // Just remove the parallax scroll effects since the hero is now fixed
            
            // Keep all your existing functionality for search, filters, animations, etc.
            // ... (keep all your existing JavaScript) ...
        });
    </script>
</Layout>